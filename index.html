<!DOCTYPE html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Pilah Sampah Pintar</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        background: #ffffff; /* Hapus biru, ganti putih bersih */
        min-height: 100vh;
        display: flex;
        justify-content: center;
        /* align-items: center; dihapus agar mulai dari atas */
        color: #333;
      }

      .game-container {
        background: white;
        /* Hapus border-radius dan shadow agar menyatu dengan layar */
        border-radius: 0;
        box-shadow: none;
        padding: 20px; /* Padding internal tetap ada */
        max-width: 800px; /* Batasi lebar konten agar enak dibaca di PC */
        width: 100%;
        display: flex;
        flex-direction: column;
        min-height: 100vh; /* Pastikan memenuhi tinggi layar */
      }

      .header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
        flex-wrap: wrap;
        gap: 15px;
        padding-bottom: 15px;
        border-bottom: 2px solid #f0f0f0;
      }

      .title {
        font-size: 1.8em;
        color: #444; /* Warna lebih netral */
        font-weight: bold;
      }

      .stats {
        display: flex;
        gap: 10px;
        align-items: center;
      }

      .stat-box {
        background: #f3f4f6; /* Ganti gradasi dengan warna solid lembut */
        color: #333;
        border: 1px solid #e5e7eb;
        padding: 8px 15px;
        border-radius: 10px;
        font-size: 1.1em;
        font-weight: bold;
        min-width: 90px;
        text-align: center;
      }

      .stat-label {
        font-size: 0.6em;
        color: #666;
        display: block;
        margin-bottom: 2px;
        text-transform: uppercase;
        letter-spacing: 1px;
      }

      .controls {
        display: flex;
        gap: 10px;
        flex-wrap: wrap;
        margin-bottom: 20px;
        justify-content: center;
      }

      .toggle-btn {
        background: white;
        border: 1px solid #ddd;
        color: #555;
        padding: 8px 15px;
        border-radius: 20px;
        font-size: 0.9em;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.2s;
        display: flex;
        align-items: center;
        gap: 5px;
      }

      .toggle-btn:hover {
        background: #f9fafb;
        border-color: #bbb;
      }

      .toggle-btn.active {
        background: #eef2ff;
        color: #4f46e5;
        border-color: #4f46e5;
      }

      .game-area {
        display: flex;
        flex-direction: column;
        gap: 20px;
        width: 100%;
        flex: 1; /* Mengisi sisa ruang */
      }

      .trash-items {
        background: #f8fafc;
        border: 2px dashed #e2e8f0;
        border-radius: 15px;
        padding: 20px;
        min-height: 200px;
        position: relative;
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        align-items: center;
        gap: 15px;
        align-content: center;
      }

      .trash-item {
        background: white;
        border: 2px solid #e2e8f0;
        border-radius: 12px;
        padding: 12px 18px;
        cursor: grab;
        transition: all 0.2s;
        font-size: 1em;
        font-weight: 600;
        color: #333;
        text-align: center;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
        touch-action: none;
        width: auto;
        max-width: 180px;
      }

      .trash-item:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        border-color: #cbd5e1;
        z-index: 10;
      }

      .trash-item.dragging {
        opacity: 0.5;
        cursor: grabbing;
      }

      .bins-container {
        display: flex;
        flex-direction: row;
        gap: 15px;
        width: 100%;
      }

      .bin {
        border: 2px solid transparent;
        border-radius: 15px;
        padding: 20px 10px;
        text-align: center;
        min-height: 140px;
        transition: all 0.3s;
        position: relative;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        flex: 1;
      }

      .bin.drag-over {
        transform: scale(1.02);
      }

      /* Warna bin dibuat sedikit lebih solid agar kontras dengan background putih */
      .bin-organic {
        background: #dcfce7;
        border-color: #86efac;
        color: #14532d;
      }

      .bin-anorganic {
        background: #fef3c7;
        border-color: #fcd34d;
        color: #78350f;
      }

      .bin-b3 {
        background: #fee2e2;
        border-color: #fca5a5;
        color: #7f1d1d;
      }

      .bin-label {
        font-size: 1.1em;
        font-weight: bold;
        margin-top: 8px;
        opacity: 0.9;
      }

      .bin-icon {
        font-size: 2.5em;
      }

      .feedback-toast {
        position: fixed;
        bottom: 30px;
        left: 50%;
        transform: translateX(-50%) translateY(100px);
        padding: 12px 25px;
        border-radius: 50px;
        font-size: 1.1em;
        font-weight: bold;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
        z-index: 1000;
        opacity: 0;
        transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      }

      .feedback-toast.show {
        transform: translateX(-50%) translateY(0);
        opacity: 1;
      }

      .feedback-toast.success {
        background: #10b981;
        color: white;
      }

      .feedback-toast.error {
        background: #ef4444;
        color: white;
      }

      .overlay-guide {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.85); /* KEMBALI KE GELAP: Fokus maksimal */
        z-index: 2000;
        display: flex;
        justify-content: center;
        align-items: center;
        opacity: 0;
        pointer-events: none;
        transition: opacity 0.3s;
        backdrop-filter: blur(5px); /* Efek blur di belakang biar makin elegan */
      }

      .overlay-guide.show {
        opacity: 1;
        pointer-events: all;
      }

      .guide-content {
        background: white;
        padding: 40px;
        border-radius: 25px;
        max-width: 550px;
        width: 90%;
        text-align: center;
        box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5); /* Shadow tebal biar melayang */
        transform: translateY(20px);
        animation: floatUp 0.4s forwards ease-out;
      }

      @keyframes floatUp {
        to {
          transform: translateY(0);
        }
      }

      .guide-content h2 {
        color: #333;
        margin-bottom: 15px;
        font-size: 2.2em;
        font-weight: 800;
      }

      .guide-steps {
        text-align: left;
        margin: 25px 0;
        padding: 25px;
        background: #f8fafc;
        border-radius: 15px;
        border: 1px solid #e2e8f0;
      }

      .guide-steps li {
        margin-bottom: 12px;
        color: #475569;
        font-size: 1.1em;
        line-height: 1.5;
      }

      .start-btn {
        background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%); /* Gradasi balik biar tombolnya 'hidup' */
        color: white;
        border: none;
        padding: 15px 40px;
        border-radius: 12px;
        font-size: 1.2em;
        font-weight: bold;
        cursor: pointer;
        transition: all 0.2s;
        box-shadow: 0 10px 20px -5px rgba(37, 99, 235, 0.4);
        width: 100%; /* Tombol full width biar gampang dipencet */
      }

      .start-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 15px 25px -5px rgba(37, 99, 235, 0.5);
      }

      .shake {
        animation: shake 0.5s;
      }
      @keyframes shake {
        0%,
        100% {
          transform: translateX(0);
        }
        25% {
          transform: translateX(-8px);
        }
        75% {
          transform: translateX(8px);
        }
      }

      .success-pulse {
        animation: successPulse 0.4s;
      }
      @keyframes successPulse {
        0%,
        100% {
          transform: scale(1);
        }
        50% {
          transform: scale(1.05);
        }
      }

      .game-over {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.8);
        z-index: 3000;
        display: none;
        justify-content: center;
        align-items: center;
      }

      .game-over.show {
        display: flex;
      }

      .game-over-content {
        background: white;
        padding: 40px;
        border-radius: 20px;
        text-align: center;
        max-width: 400px;
        width: 90%;
        box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
      }

      .final-score {
        font-size: 4em;
        font-weight: 800;
        color: #2563eb;
        margin: 10px 0;
      }

      @media (max-width: 768px) {
        .bins-container {
          flex-direction: column;
        }

        .game-area {
          flex-direction: column;
        }

        .trash-items {
          min-height: 180px;
        }

        .bin {
          flex-direction: row;
          justify-content: flex-start;
          padding: 15px;
          gap: 20px;
          min-height: 70px;
          text-align: left;
        }

        .bin-icon {
          font-size: 2em;
        }

        .bin-label {
          margin-top: 0;
          font-size: 1em;
        }

        .header {
          padding-bottom: 10px;
          margin-bottom: 15px;
        }

        .title {
          font-size: 1.5em;
        }
      }
    </style>
  </head>
  <body>
    <div class="game-container">
      <div class="header">
        <h1 class="title">üå± Pilah Sampah</h1>
        <div class="stats">
          <div class="stat-box">
            <span class="stat-label">Skor</span>
            <span id="score">0</span>
          </div>
          <div class="stat-box">
            <span class="stat-label">Waktu</span>
            <span id="timer">60</span>
          </div>
        </div>
      </div>

      <div class="controls">
        <button class="toggle-btn active" id="soundToggle"><span>üîä</span> <span>Suara</span></button>
        <button class="toggle-btn active" id="hapticToggle"><span>üì≥</span> <span>Getaran</span></button>
        <button class="toggle-btn" id="helpToggle"><span>‚ùì</span> <span>Panduan</span></button>
      </div>

      <div class="game-area">
        <!-- Area Sampah -->
        <div class="trash-items" id="trashItems">
          <!-- Items will be generated here -->
        </div>

        <!-- Area Tong Sampah -->
        <div class="bins-container">
          <div class="bin bin-organic" data-type="organic">
            <div class="bin-icon">ü•¨</div>
            <div class="bin-label">ORGANIK</div>
          </div>
          <div class="bin bin-anorganic" data-type="anorganic">
            <div class="bin-icon">‚ôªÔ∏è</div>
            <div class="bin-label">ANORGANIK</div>
          </div>
          <div class="bin bin-b3" data-type="b3">
            <div class="bin-icon">‚ò†Ô∏è</div>
            <div class="bin-label">B3 (KIMIA)</div>
          </div>
        </div>
      </div>
    </div>

    <div class="feedback-toast" id="feedbackToast"></div>

    <div class="overlay-guide show" id="overlayGuide">
      <div class="guide-content">
        <h2>üéÆ Cara Bermain</h2>
        <div class="guide-steps">
          <ol>
            <li><strong>Seret sampah</strong> dari area atas ke tong yang sesuai.</li>
            <li><strong>Organik:</strong> Sisa makanan, daun, kulit buah.</li>
            <li><strong>Anorganik:</strong> Plastik, kertas, kaleng.</li>
            <li><strong>B3:</strong> Baterai, limbah medis/kimia.</li>
            <li>Benar dapat poin, salah kurangi poin.</li>
          </ol>
        </div>
        <button class="start-btn" onclick="startGame()">Mulai Bermain</button>
      </div>
    </div>

    <div class="game-over" id="gameOver">
      <div class="game-over-content">
        <h2>üéâ Selesai!</h2>
        <p>Skor Akhir Kamu</p>
        <div class="final-score" id="finalScore">0</div>
        <button class="start-btn" onclick="restartGame()">Main Lagi</button>
      </div>
    </div>

    <script>
      const trashData = [
        { name: "üçå Kulit Pisang", type: "organic" },
        { name: "ü•§ Botol Plastik", type: "anorganic" },
        { name: "üîã Baterai Bekas", type: "b3" },
        { name: "üçÉ Daun Kering", type: "organic" },
        { name: "üì∞ Kertas Bekas", type: "anorganic" },
        { name: "üí° Lampu Neon", type: "b3" },
        { name: "üçé Sisa Apel", type: "organic" },
        { name: "ü•´ Kaleng Minuman", type: "anorganic" },
        { name: "üß¥ Botol Obat", type: "b3" },
        { name: "üåΩ Tongkol Jagung", type: "organic" },
        { name: "üì¶ Kardus Bekas", type: "anorganic" },
        { name: "üî¨ Limbah Kimia", type: "b3" },
        { name: "‚òï Ampas Kopi", type: "organic" },
        { name: "üõçÔ∏è Kantong Plastik", type: "anorganic" },
        { name: "ü©π Plester Bekas", type: "b3" },
        { name: "ü¶¥ Tulang Ayam", type: "organic" },
        { name: "ü•° Styrofoam", type: "anorganic" },
        { name: "üß™ Cairan Pembersih", type: "b3" },
      ];

      let score = 0;
      let timeLeft = 60;
      let gameActive = false;
      let soundEnabled = true;
      let hapticEnabled = true;
      let timerInterval;
      let currentTrash = [];

      function initGame() {
        document.getElementById("soundToggle").addEventListener("click", toggleSound);
        document.getElementById("hapticToggle").addEventListener("click", toggleHaptic);
        document.getElementById("helpToggle").addEventListener("click", showHelp);

        const bins = document.querySelectorAll(".bin");
        bins.forEach((bin) => {
          bin.addEventListener("dragover", handleDragOver);
          bin.addEventListener("drop", handleDrop);
          bin.addEventListener("dragleave", handleDragLeave);
        });
      }

      function startGame() {
        document.getElementById("overlayGuide").classList.remove("show");
        gameActive = true;
        score = 0;
        timeLeft = 60;
        updateScore();
        updateTimer();
        generateTrash();
        startTimer();
      }

      function generateTrash() {
        const container = document.getElementById("trashItems");
        container.innerHTML = "";
        currentTrash = [];

        const shuffled = [...trashData].sort(() => Math.random() - 0.5);
        const selected = shuffled.slice(0, 6); // Tampilkan 6 item sekaligus

        selected.forEach((item, index) => {
          const trashElement = document.createElement("div");
          trashElement.className = "trash-item";
          trashElement.draggable = true;
          trashElement.textContent = item.name;
          trashElement.dataset.type = item.type;

          trashElement.addEventListener("dragstart", handleDragStart);
          trashElement.addEventListener("dragend", handleDragEnd);

          trashElement.addEventListener("touchstart", handleTouchStart);
          trashElement.addEventListener("touchmove", handleTouchMove);
          trashElement.addEventListener("touchend", handleTouchEnd);

          container.appendChild(trashElement);
          currentTrash.push(item);
        });
      }

      let draggedElement = null;
      let touchClone = null;

      function handleDragStart(e) {
        draggedElement = e.target;
        e.target.classList.add("dragging");
        e.dataTransfer.effectAllowed = "move";
      }

      function handleDragEnd(e) {
        e.target.classList.remove("dragging");
      }

      function handleDragOver(e) {
        e.preventDefault();
        e.currentTarget.classList.add("drag-over");
      }

      function handleDragLeave(e) {
        e.currentTarget.classList.remove("drag-over");
      }

      function handleDrop(e) {
        e.preventDefault();
        e.currentTarget.classList.remove("drag-over");

        if (!gameActive || !draggedElement) return;

        const binType = e.currentTarget.dataset.type;
        const trashType = draggedElement.dataset.type;

        checkAnswer(binType, trashType, draggedElement, e.currentTarget);
      }

      function handleTouchStart(e) {
        draggedElement = e.target;
        touchClone = e.target.cloneNode(true);
        touchClone.style.position = "fixed";
        touchClone.style.opacity = "0.9";
        touchClone.style.width = e.target.offsetWidth + "px";
        touchClone.style.pointerEvents = "none";
        touchClone.style.zIndex = "5000";
        touchClone.style.transform = "scale(1.05)";
        touchClone.style.boxShadow = "0 10px 20px rgba(0,0,0,0.2)";
        document.body.appendChild(touchClone);
        updateTouchClonePosition(e.touches[0]);
      }

      function handleTouchMove(e) {
        e.preventDefault();
        if (touchClone) {
          updateTouchClonePosition(e.touches[0]);
        }
      }

      function updateTouchClonePosition(touch) {
        if (touchClone) {
          touchClone.style.left = touch.clientX - touchClone.offsetWidth / 2 + "px";
          touchClone.style.top = touch.clientY - touchClone.offsetHeight / 2 + "px";
        }
      }

      function handleTouchEnd(e) {
        if (!touchClone) return;

        const touch = e.changedTouches[0];
        touchClone.style.display = "none";
        const target = document.elementFromPoint(touch.clientX, touch.clientY);
        touchClone.style.display = "block";

        const bin = target ? target.closest(".bin") : null;

        if (bin) {
          const binType = bin.dataset.type;
          const trashType = draggedElement.dataset.type;
          checkAnswer(binType, trashType, draggedElement, bin);
        }

        if (touchClone && touchClone.parentNode) {
          touchClone.parentNode.removeChild(touchClone);
        }
        touchClone = null;
        draggedElement = null;
      }

      function checkAnswer(binType, trashType, trashElement, binElement) {
        if (binType === trashType) {
          score += 10;
          showFeedback("‚úÖ Benar!", "success");
          playSound("success");
          vibrate([50]);
          binElement.classList.add("success-pulse");
          setTimeout(() => binElement.classList.remove("success-pulse"), 500);
        } else {
          score = Math.max(0, score - 5);
          showFeedback("‚ùå Salah!", "error");
          playSound("error");
          vibrate([100, 50, 100]);
          trashElement.classList.add("shake");
          setTimeout(() => trashElement.classList.remove("shake"), 500);
          return;
        }

        updateScore();
        trashElement.remove();

        if (document.querySelectorAll(".trash-item").length === 0) {
          setTimeout(generateTrash, 300);
        }
      }

      function showFeedback(message, type) {
        const toast = document.getElementById("feedbackToast");
        toast.textContent = message;
        toast.className = `feedback-toast ${type} show`;
        setTimeout(() => toast.classList.remove("show"), 1500);
      }

      function playSound(type) {
        if (!soundEnabled) return;
        const ctx = new (window.AudioContext || window.webkitAudioContext)();
        const osc = ctx.createOscillator();
        const gain = ctx.createGain();
        osc.connect(gain);
        gain.connect(ctx.destination);

        if (type === "success") {
          osc.frequency.setValueAtTime(600, ctx.currentTime);
          osc.frequency.exponentialRampToValueAtTime(1200, ctx.currentTime + 0.1);
          gain.gain.setValueAtTime(0.3, ctx.currentTime);
          gain.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.2);
        } else {
          osc.frequency.setValueAtTime(200, ctx.currentTime);
          osc.frequency.linearRampToValueAtTime(100, ctx.currentTime + 0.2);
          osc.type = "sawtooth";
          gain.gain.setValueAtTime(0.3, ctx.currentTime);
          gain.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.2);
        }

        osc.start();
        osc.stop(ctx.currentTime + 0.2);
      }

      function vibrate(pattern) {
        if (hapticEnabled && navigator.vibrate) navigator.vibrate(pattern);
      }

      function updateScore() {
        document.getElementById("score").textContent = score;
      }
      function updateTimer() {
        document.getElementById("timer").textContent = timeLeft;
      }

      function startTimer() {
        if (timerInterval) clearInterval(timerInterval);
        timerInterval = setInterval(() => {
          timeLeft--;
          updateTimer();
          if (timeLeft <= 0) endGame();
        }, 1000);
      }

      function endGame() {
        gameActive = false;
        clearInterval(timerInterval);
        document.getElementById("finalScore").textContent = score;
        document.getElementById("gameOver").classList.add("show");
      }

      function restartGame() {
        document.getElementById("gameOver").classList.remove("show");
        startGame();
      }

      function toggleSound() {
        soundEnabled = !soundEnabled;
        const btn = document.getElementById("soundToggle");
        btn.classList.toggle("active");
        btn.querySelector("span:first-child").textContent = soundEnabled ? "üîä" : "üîá";
      }

      function toggleHaptic() {
        hapticEnabled = !hapticEnabled;
        const btn = document.getElementById("hapticToggle");
        btn.classList.toggle("active");
        btn.querySelector("span:first-child").textContent = hapticEnabled ? "üì≥" : "üì¥";
      }

      function showHelp() {
        document.getElementById("overlayGuide").classList.add("show");
      }

      initGame();
    </script>
  </body>
</html>
